apiVersion: admissionregistration.k8s.io/v1beta1
kind: MutatingWebhookConfiguration
metadata:
  creationTimestamp: null
  name: mutating-webhook-configuration
  namespace: kubesphere-devops-system
webhooks:
- clientConfig:
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURZekNDQWt1Z0F3SUJBZ0lKQU5zV3R0ZXdwb0FLTUEwR0NTcUdTSWIzRFFFQkN3VUFNRWd4Q3pBSkJnTlYKQkFZVEFrTk9NUXN3Q1FZRFZRUUlEQUpJUWpFTE1Ba0dBMVVFQ2d3Q1VVTXhIekFkQmdOVkJBTU1GbmRsWW1odgpiMnN0YzJWeWRtVnlMWE5sY25acFkyVXdIaGNOTWpBeE1UTXdNREkwTlRFNFdoY05ORGd3TkRFM01ESTBOVEU0CldqQklNUXN3Q1FZRFZRUUdFd0pEVGpFTE1Ba0dBMVVFQ0F3Q1NFSXhDekFKQmdOVkJBb01BbEZETVI4d0hRWUQKVlFRRERCWjNaV0pvYjI5ckxYTmxjblpsY2kxelpYSjJhV05sTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQwpBUThBTUlJQkNnS0NBUUVBeDZDb3l0UTRnbHlyZGRGUy9hSDZ2TU96SXpORHJQNDd6M2xkVVkyMXBGdzA4aUUyCmFTcGRqNHVHQkh6K2RSczdpaDd2eWo0aDZuMDdiaElUYkJTSzJPTHp1S0I5Y3hzRnJFRTNTVTdIVWh5SkxsengKRi9ic29CbWxIN3NRNkdsRzJ6dkFDMUJ0eVd4VmVlL0QrZlByQ01WZVRmNURMaHdZK2ZMM2M0STdNL3dkeU05bAo5MzBSVkJlNHNZOEkyYzNTdW1PNHlnVHlmTkNCL3crT1ZWOUpueDNkV2JqTkRVRU01azQzQjJURkxHcXMxS2pLCk1YemZSVDI4WTZyM2tNRTZwZHAzaHZ5REliZEY2WVJ0VmJ4ZzRQakphSWZVWkEyREZRWlIzeWFkQ1hnK0xiZE8KbmFKVUlZMzA4eUNxMzd4YzRMdkdzMGJ6S1I1UURqV2xXUktOSFFJREFRQUJvMUF3VGpBZEJnTlZIUTRFRmdRVQpkTU5VRFRsOSttYlhiUEtxdzYxUkJhK0w5c0l3SHdZRFZSMGpCQmd3Rm9BVWRNTlVEVGw5K21iWGJQS3F3NjFSCkJhK0w5c0l3REFZRFZSMFRCQVV3QXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFSSHpiQkF3cmxWYzAKeDZsSTk0eG00KzRVZUw0UGlJeVB1SU9IMitXdFAySnBCODlpSkxxUUFDeE1VSVFnN1luN0l2VXJGUkhYckZoSQpVYm5ZWTFwaFdVUjRJNzNXbC9RRmR3aERqNmZxdUJwODhQTUw1UW1KK2VEdDg4TVdyRGJRYjEzbi9sZFNFNEVjClVJdUNYV3phYis0a1V4VkZPcVIzSkkxOG9FVVBkODlUMDVEUmw3MHZ1ZGdZdllZZUtEV0NkYTFMY2ZGR0trREEKSlJpcnZOalRNajdyZFM5RTdqd2FPNDVOUDNJZi8yOTVaSUh6OUxMWjYwREgwSjJ4Q1RwODAyaEw3SWY5VnVXLwo2YmZoNGRCTE9MVGJiNEtPTzR5NUFCMVJoUWJWQ0R2MGRWbW94VE5FQVlhbjFMWFZKdFZLOU9oWVVDckRYN2diClI1SG9IdTV4cnc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    service:
      name: webhook-server-service
      namespace: kubesphere-devops-system
      path: /mutate-devops-kubesphere-io-v1alpha1-s2ibuilder
  failurePolicy: Fail
  name: s2ibuilder.kb.io
  rules:
  - apiGroups:
    - devops.kubesphere.io
    apiVersions:
    - v1alpha1
    operations:
    - CREATE
    - UPDATE
    resources:
    - s2ibuilders
---
apiVersion: admissionregistration.k8s.io/v1beta1
kind: ValidatingWebhookConfiguration
metadata:
  creationTimestamp: null
  name: validating-webhook-configuration
  namespace: kubesphere-devops-system
webhooks:
- clientConfig:
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURZekNDQWt1Z0F3SUJBZ0lKQU5zV3R0ZXdwb0FLTUEwR0NTcUdTSWIzRFFFQkN3VUFNRWd4Q3pBSkJnTlYKQkFZVEFrTk9NUXN3Q1FZRFZRUUlEQUpJUWpFTE1Ba0dBMVVFQ2d3Q1VVTXhIekFkQmdOVkJBTU1GbmRsWW1odgpiMnN0YzJWeWRtVnlMWE5sY25acFkyVXdIaGNOTWpBeE1UTXdNREkwTlRFNFdoY05ORGd3TkRFM01ESTBOVEU0CldqQklNUXN3Q1FZRFZRUUdFd0pEVGpFTE1Ba0dBMVVFQ0F3Q1NFSXhDekFKQmdOVkJBb01BbEZETVI4d0hRWUQKVlFRRERCWjNaV0pvYjI5ckxYTmxjblpsY2kxelpYSjJhV05sTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQwpBUThBTUlJQkNnS0NBUUVBeDZDb3l0UTRnbHlyZGRGUy9hSDZ2TU96SXpORHJQNDd6M2xkVVkyMXBGdzA4aUUyCmFTcGRqNHVHQkh6K2RSczdpaDd2eWo0aDZuMDdiaElUYkJTSzJPTHp1S0I5Y3hzRnJFRTNTVTdIVWh5SkxsengKRi9ic29CbWxIN3NRNkdsRzJ6dkFDMUJ0eVd4VmVlL0QrZlByQ01WZVRmNURMaHdZK2ZMM2M0STdNL3dkeU05bAo5MzBSVkJlNHNZOEkyYzNTdW1PNHlnVHlmTkNCL3crT1ZWOUpueDNkV2JqTkRVRU01azQzQjJURkxHcXMxS2pLCk1YemZSVDI4WTZyM2tNRTZwZHAzaHZ5REliZEY2WVJ0VmJ4ZzRQakphSWZVWkEyREZRWlIzeWFkQ1hnK0xiZE8KbmFKVUlZMzA4eUNxMzd4YzRMdkdzMGJ6S1I1UURqV2xXUktOSFFJREFRQUJvMUF3VGpBZEJnTlZIUTRFRmdRVQpkTU5VRFRsOSttYlhiUEtxdzYxUkJhK0w5c0l3SHdZRFZSMGpCQmd3Rm9BVWRNTlVEVGw5K21iWGJQS3F3NjFSCkJhK0w5c0l3REFZRFZSMFRCQVV3QXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFSSHpiQkF3cmxWYzAKeDZsSTk0eG00KzRVZUw0UGlJeVB1SU9IMitXdFAySnBCODlpSkxxUUFDeE1VSVFnN1luN0l2VXJGUkhYckZoSQpVYm5ZWTFwaFdVUjRJNzNXbC9RRmR3aERqNmZxdUJwODhQTUw1UW1KK2VEdDg4TVdyRGJRYjEzbi9sZFNFNEVjClVJdUNYV3phYis0a1V4VkZPcVIzSkkxOG9FVVBkODlUMDVEUmw3MHZ1ZGdZdllZZUtEV0NkYTFMY2ZGR0trREEKSlJpcnZOalRNajdyZFM5RTdqd2FPNDVOUDNJZi8yOTVaSUh6OUxMWjYwREgwSjJ4Q1RwODAyaEw3SWY5VnVXLwo2YmZoNGRCTE9MVGJiNEtPTzR5NUFCMVJoUWJWQ0R2MGRWbW94VE5FQVlhbjFMWFZKdFZLOU9oWVVDckRYN2diClI1SG9IdTV4cnc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    service:
      name: webhook-server-service
      namespace: kubesphere-devops-system
      path: /validate-devops-kubesphere-io-v1alpha1-s2ibuilder
  failurePolicy: Fail
  name: vs2ibuilder.kb.io
  rules:
  - apiGroups:
    - devops.kubesphere.io
    apiVersions:
    - v1alpha1
    operations:
    - CREATE
    - UPDATE
    resources:
    - s2ibuilders
- clientConfig:
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURZekNDQWt1Z0F3SUJBZ0lKQU5zV3R0ZXdwb0FLTUEwR0NTcUdTSWIzRFFFQkN3VUFNRWd4Q3pBSkJnTlYKQkFZVEFrTk9NUXN3Q1FZRFZRUUlEQUpJUWpFTE1Ba0dBMVVFQ2d3Q1VVTXhIekFkQmdOVkJBTU1GbmRsWW1odgpiMnN0YzJWeWRtVnlMWE5sY25acFkyVXdIaGNOTWpBeE1UTXdNREkwTlRFNFdoY05ORGd3TkRFM01ESTBOVEU0CldqQklNUXN3Q1FZRFZRUUdFd0pEVGpFTE1Ba0dBMVVFQ0F3Q1NFSXhDekFKQmdOVkJBb01BbEZETVI4d0hRWUQKVlFRRERCWjNaV0pvYjI5ckxYTmxjblpsY2kxelpYSjJhV05sTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQwpBUThBTUlJQkNnS0NBUUVBeDZDb3l0UTRnbHlyZGRGUy9hSDZ2TU96SXpORHJQNDd6M2xkVVkyMXBGdzA4aUUyCmFTcGRqNHVHQkh6K2RSczdpaDd2eWo0aDZuMDdiaElUYkJTSzJPTHp1S0I5Y3hzRnJFRTNTVTdIVWh5SkxsengKRi9ic29CbWxIN3NRNkdsRzJ6dkFDMUJ0eVd4VmVlL0QrZlByQ01WZVRmNURMaHdZK2ZMM2M0STdNL3dkeU05bAo5MzBSVkJlNHNZOEkyYzNTdW1PNHlnVHlmTkNCL3crT1ZWOUpueDNkV2JqTkRVRU01azQzQjJURkxHcXMxS2pLCk1YemZSVDI4WTZyM2tNRTZwZHAzaHZ5REliZEY2WVJ0VmJ4ZzRQakphSWZVWkEyREZRWlIzeWFkQ1hnK0xiZE8KbmFKVUlZMzA4eUNxMzd4YzRMdkdzMGJ6S1I1UURqV2xXUktOSFFJREFRQUJvMUF3VGpBZEJnTlZIUTRFRmdRVQpkTU5VRFRsOSttYlhiUEtxdzYxUkJhK0w5c0l3SHdZRFZSMGpCQmd3Rm9BVWRNTlVEVGw5K21iWGJQS3F3NjFSCkJhK0w5c0l3REFZRFZSMFRCQVV3QXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFSSHpiQkF3cmxWYzAKeDZsSTk0eG00KzRVZUw0UGlJeVB1SU9IMitXdFAySnBCODlpSkxxUUFDeE1VSVFnN1luN0l2VXJGUkhYckZoSQpVYm5ZWTFwaFdVUjRJNzNXbC9RRmR3aERqNmZxdUJwODhQTUw1UW1KK2VEdDg4TVdyRGJRYjEzbi9sZFNFNEVjClVJdUNYV3phYis0a1V4VkZPcVIzSkkxOG9FVVBkODlUMDVEUmw3MHZ1ZGdZdllZZUtEV0NkYTFMY2ZGR0trREEKSlJpcnZOalRNajdyZFM5RTdqd2FPNDVOUDNJZi8yOTVaSUh6OUxMWjYwREgwSjJ4Q1RwODAyaEw3SWY5VnVXLwo2YmZoNGRCTE9MVGJiNEtPTzR5NUFCMVJoUWJWQ0R2MGRWbW94VE5FQVlhbjFMWFZKdFZLOU9oWVVDckRYN2diClI1SG9IdTV4cnc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    service:
      name: webhook-server-service
      namespace: kubesphere-devops-system
      path: /validate-devops-kubesphere-io-v1alpha1-s2ibuildertemplate
  failurePolicy: Fail
  name: s2ibuildertemplate.kb.io
  rules:
  - apiGroups:
    - devops.kubesphere.io
    apiVersions:
    - v1alpha1
    operations:
    - CREATE
    - UPDATE
    resources:
    - s2ibuildertemplates
- clientConfig:
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURZekNDQWt1Z0F3SUJBZ0lKQU5zV3R0ZXdwb0FLTUEwR0NTcUdTSWIzRFFFQkN3VUFNRWd4Q3pBSkJnTlYKQkFZVEFrTk9NUXN3Q1FZRFZRUUlEQUpJUWpFTE1Ba0dBMVVFQ2d3Q1VVTXhIekFkQmdOVkJBTU1GbmRsWW1odgpiMnN0YzJWeWRtVnlMWE5sY25acFkyVXdIaGNOTWpBeE1UTXdNREkwTlRFNFdoY05ORGd3TkRFM01ESTBOVEU0CldqQklNUXN3Q1FZRFZRUUdFd0pEVGpFTE1Ba0dBMVVFQ0F3Q1NFSXhDekFKQmdOVkJBb01BbEZETVI4d0hRWUQKVlFRRERCWjNaV0pvYjI5ckxYTmxjblpsY2kxelpYSjJhV05sTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQwpBUThBTUlJQkNnS0NBUUVBeDZDb3l0UTRnbHlyZGRGUy9hSDZ2TU96SXpORHJQNDd6M2xkVVkyMXBGdzA4aUUyCmFTcGRqNHVHQkh6K2RSczdpaDd2eWo0aDZuMDdiaElUYkJTSzJPTHp1S0I5Y3hzRnJFRTNTVTdIVWh5SkxsengKRi9ic29CbWxIN3NRNkdsRzJ6dkFDMUJ0eVd4VmVlL0QrZlByQ01WZVRmNURMaHdZK2ZMM2M0STdNL3dkeU05bAo5MzBSVkJlNHNZOEkyYzNTdW1PNHlnVHlmTkNCL3crT1ZWOUpueDNkV2JqTkRVRU01azQzQjJURkxHcXMxS2pLCk1YemZSVDI4WTZyM2tNRTZwZHAzaHZ5REliZEY2WVJ0VmJ4ZzRQakphSWZVWkEyREZRWlIzeWFkQ1hnK0xiZE8KbmFKVUlZMzA4eUNxMzd4YzRMdkdzMGJ6S1I1UURqV2xXUktOSFFJREFRQUJvMUF3VGpBZEJnTlZIUTRFRmdRVQpkTU5VRFRsOSttYlhiUEtxdzYxUkJhK0w5c0l3SHdZRFZSMGpCQmd3Rm9BVWRNTlVEVGw5K21iWGJQS3F3NjFSCkJhK0w5c0l3REFZRFZSMFRCQVV3QXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFSSHpiQkF3cmxWYzAKeDZsSTk0eG00KzRVZUw0UGlJeVB1SU9IMitXdFAySnBCODlpSkxxUUFDeE1VSVFnN1luN0l2VXJGUkhYckZoSQpVYm5ZWTFwaFdVUjRJNzNXbC9RRmR3aERqNmZxdUJwODhQTUw1UW1KK2VEdDg4TVdyRGJRYjEzbi9sZFNFNEVjClVJdUNYV3phYis0a1V4VkZPcVIzSkkxOG9FVVBkODlUMDVEUmw3MHZ1ZGdZdllZZUtEV0NkYTFMY2ZGR0trREEKSlJpcnZOalRNajdyZFM5RTdqd2FPNDVOUDNJZi8yOTVaSUh6OUxMWjYwREgwSjJ4Q1RwODAyaEw3SWY5VnVXLwo2YmZoNGRCTE9MVGJiNEtPTzR5NUFCMVJoUWJWQ0R2MGRWbW94VE5FQVlhbjFMWFZKdFZLOU9oWVVDckRYN2diClI1SG9IdTV4cnc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    service:
      name: webhook-server-service
      namespace: kubesphere-devops-system
      path: /validate-devops-kubesphere-io-v1alpha1-s2irun
  failurePolicy: Fail
  name: vs2irun.kb.io
  rules:
  - apiGroups:
    - devops.kubesphere.io
    apiVersions:
    - v1alpha1
    operations:
    - CREATE
    - UPDATE
    resources:
    - s2iruns
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  creationTimestamp: null
  name: manager-role
rules:
- apiGroups:
  - devops.kubesphere.io
  resources:
  - s2ibuilders
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - devops.kubesphere.io
  resources:
  - s2ibuilders/status
  verbs:
  - get
  - update
  - patch
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - patch
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - batch
  resources:
  - jobs
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - devops.kubesphere.io
  resources:
  - s2iruns
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - devops.kubesphere.io
  resources:
  - s2iruns/status
  verbs:
  - get
  - update
  - patch
- apiGroups:
  - devops.kubesphere.io
  resources:
  - s2ibuildertemplates
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - get
  - list
  - watch
  - update
  - patch
- apiGroups:
  - apps
  resources:
  - statefulsets
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
- apiGroups:
  - apps
  resources:
  - deployments
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
- apiGroups:
  - extensions
  resources:
  - deployments
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
- apiGroups:
  - ""
  resources:
  - serviceaccounts
  verbs:
  - get
  - list
  - watch
  - create
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - rolebindings
  verbs:
  - get
  - list
  - watch
  - create
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - roles
  verbs:
  - get
  - list
  - watch
  - create
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - services
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - deployments
  verbs:
  - get
  - list
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: proxy-role
rules:
- apiGroups:
  - authentication.k8s.io
  resources:
  - tokenreviews
  verbs:
  - create
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  creationTimestamp: null
  name: manager-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: manager-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: kubesphere-devops-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: proxy-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: proxy-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: kubesphere-devops-system
---
apiVersion: v1
data:
  caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURZekNDQWt1Z0F3SUJBZ0lKQU5zV3R0ZXdwb0FLTUEwR0NTcUdTSWIzRFFFQkN3VUFNRWd4Q3pBSkJnTlYKQkFZVEFrTk9NUXN3Q1FZRFZRUUlEQUpJUWpFTE1Ba0dBMVVFQ2d3Q1VVTXhIekFkQmdOVkJBTU1GbmRsWW1odgpiMnN0YzJWeWRtVnlMWE5sY25acFkyVXdIaGNOTWpBeE1UTXdNREkwTlRFNFdoY05ORGd3TkRFM01ESTBOVEU0CldqQklNUXN3Q1FZRFZRUUdFd0pEVGpFTE1Ba0dBMVVFQ0F3Q1NFSXhDekFKQmdOVkJBb01BbEZETVI4d0hRWUQKVlFRRERCWjNaV0pvYjI5ckxYTmxjblpsY2kxelpYSjJhV05sTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQwpBUThBTUlJQkNnS0NBUUVBeDZDb3l0UTRnbHlyZGRGUy9hSDZ2TU96SXpORHJQNDd6M2xkVVkyMXBGdzA4aUUyCmFTcGRqNHVHQkh6K2RSczdpaDd2eWo0aDZuMDdiaElUYkJTSzJPTHp1S0I5Y3hzRnJFRTNTVTdIVWh5SkxsengKRi9ic29CbWxIN3NRNkdsRzJ6dkFDMUJ0eVd4VmVlL0QrZlByQ01WZVRmNURMaHdZK2ZMM2M0STdNL3dkeU05bAo5MzBSVkJlNHNZOEkyYzNTdW1PNHlnVHlmTkNCL3crT1ZWOUpueDNkV2JqTkRVRU01azQzQjJURkxHcXMxS2pLCk1YemZSVDI4WTZyM2tNRTZwZHAzaHZ5REliZEY2WVJ0VmJ4ZzRQakphSWZVWkEyREZRWlIzeWFkQ1hnK0xiZE8KbmFKVUlZMzA4eUNxMzd4YzRMdkdzMGJ6S1I1UURqV2xXUktOSFFJREFRQUJvMUF3VGpBZEJnTlZIUTRFRmdRVQpkTU5VRFRsOSttYlhiUEtxdzYxUkJhK0w5c0l3SHdZRFZSMGpCQmd3Rm9BVWRNTlVEVGw5K21iWGJQS3F3NjFSCkJhK0w5c0l3REFZRFZSMFRCQVV3QXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFSSHpiQkF3cmxWYzAKeDZsSTk0eG00KzRVZUw0UGlJeVB1SU9IMitXdFAySnBCODlpSkxxUUFDeE1VSVFnN1luN0l2VXJGUkhYckZoSQpVYm5ZWTFwaFdVUjRJNzNXbC9RRmR3aERqNmZxdUJwODhQTUw1UW1KK2VEdDg4TVdyRGJRYjEzbi9sZFNFNEVjClVJdUNYV3phYis0a1V4VkZPcVIzSkkxOG9FVVBkODlUMDVEUmw3MHZ1ZGdZdllZZUtEV0NkYTFMY2ZGR0trREEKSlJpcnZOalRNajdyZFM5RTdqd2FPNDVOUDNJZi8yOTVaSUh6OUxMWjYwREgwSjJ4Q1RwODAyaEw3SWY5VnVXLwo2YmZoNGRCTE9MVGJiNEtPTzR5NUFCMVJoUWJWQ0R2MGRWbW94VE5FQVlhbjFMWFZKdFZLOU9oWVVDckRYN2diClI1SG9IdTV4cnc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLVENDQWhFQ0NRRHBnZUc4ak9PQlZUQU5CZ2txaGtpRzl3MEJBUXNGQURCSU1Rc3dDUVlEVlFRR0V3SkQKVGpFTE1Ba0dBMVVFQ0F3Q1NFSXhDekFKQmdOVkJBb01BbEZETVI4d0hRWURWUVFEREJaM1pXSm9iMjlyTFhObApjblpsY2kxelpYSjJhV05sTUI0WERUSXdNVEV6TURBeU5EVXhPRm9YRFRRNE1EUXhOekF5TkRVeE9Gb3daVEVMCk1Ba0dBMVVFQmhNQ1EwNHhDekFKQmdOVkJBZ01Ba2hDTVFzd0NRWURWUVFLREFKUlF6RThNRG9HQTFVRUF3d3oKZDJWaWFHOXZheTF6WlhKMlpYSXRjMlZ5ZG1salpTNXJkV0psYzNCb1pYSmxMV1JsZG05d2N5MXplWE4wWlcwdQpjM1pqTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF6cVMxTUNyYUxTOGlBaFRwClFiK2hnaGFoK3JmM1dNVE4vSXhnZVdxV3orTVMyNGxnWitVY1A3YmJxcGtTWHd1bWFCeXFGaUNVUkw1SVNLd1oKYjF6TjJtaUFPL09rbHlGZVFGeGFubGswbzQ5Nlp0cDM0Wm9YUWNmcnJSNml6RkdwWk5DZ283QSttSFV1d0VONwpDWXVoWVAxRTFnMVJrMmJQSHgrQlJjOGpENUJZSjV2YlRRc2RLTE5ITEgvTGdVREtySC9QVy9sZDdHR0pqNDN0CjdPdk5PTXBRaWNlOFNKM2ZBdkhCVmtWVVJ6ZldlZk15SytlSWxnM2I1UVhLQ0R5VGlERTd1ODU1RXJzc1UrRTEKbldLRWZQM1owWjJUc2hCa2FuV0RtakNnVWpjUkQxakdSVWxXekRrNlhUYW9GaFNrZWttakZtREQ4WDh1T0NQSApqSXhIK1FJREFRQUJNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUM3QmgwaUwyRmVNUzFoU1BEVVVXQUVDN2NpCnpYYklmRG8raDhBcjdmcTJUOVBCWlNLQjVKSnQwMWlyTlkvUzlkUjdJaHpmMlVtME5kZURnZnRwUzdmSEhzQm8KcVltZHZwOGdzMjl5TFF3U3hkdWNLWGhlZldMdjlKOGpMaHFrbDNrMkN6T3kvK2s4bW94UldoZlB4NTRpdkRLNgpsQVdCQ0NiTlpPU2xJb2FnbW5mNi9xVUFTUEd3Mk1iTXpIdnFJWjF4NzQwYVRmS2tMLzdpeTN6YjMrOWE0dlhqCk00MVBrRlVsYTRiNzBNT1ZwNXVNN0NXNGE5clhyekRTTVBvd0dpRXlGNUdFMVBHSTlMUnJ6VVoyYnhyVXdZR3YKbkFabTJtKzVrclNqdngrb0IwekNtYnFGRmgxVE5PUzh0dGJRUXhaNWVzbHhHTWx2Ti9PZnRwZ04vV0dSCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBenFTMU1DcmFMUzhpQWhUcFFiK2hnaGFoK3JmM1dNVE4vSXhnZVdxV3orTVMyNGxnClorVWNQN2JicXBrU1h3dW1hQnlxRmlDVVJMNUlTS3daYjF6TjJtaUFPL09rbHlGZVFGeGFubGswbzQ5Nlp0cDMKNFpvWFFjZnJyUjZpekZHcFpOQ2dvN0ErbUhVdXdFTjdDWXVoWVAxRTFnMVJrMmJQSHgrQlJjOGpENUJZSjV2YgpUUXNkS0xOSExIL0xnVURLckgvUFcvbGQ3R0dKajQzdDdPdk5PTXBRaWNlOFNKM2ZBdkhCVmtWVVJ6ZldlZk15CksrZUlsZzNiNVFYS0NEeVRpREU3dTg1NUVyc3NVK0UxbldLRWZQM1owWjJUc2hCa2FuV0RtakNnVWpjUkQxakcKUlVsV3pEazZYVGFvRmhTa2VrbWpGbUREOFg4dU9DUEhqSXhIK1FJREFRQUJBb0lCQUI0SWVFRUE2V2JKdytLVAprWGM1MThwbGFiTmJ5M28rV0VYTlRUUTRWcVR1TnM1cmYvUjVxd3BqbERlT09jcFFraVh0akpiY3MwL3VhK2tNCkFrSmFOWno1dFRHQmJybDhZd3R0b01vRTR3Nm1pcjZxSCtSTkZmWThqVGRERFp3dWZqVWwwVU1aR1cvbEVCOW4KYjFscXp0Q2Uzc05SZWpxM0pZRTdmZmxjYXBjWE81VDh3L3NvNE5kK3RXcC8yM0hCTUpRZGlyQjNZUlI5bXk2VQoxRDVsWWp4UGJTWHRlNG9NVzFJNDZvVFBYMWg1cHA1SUo3bVY1L1ViZkptc20yTnRYZDlYcW53cGxBWjg1czhSCm5IRmVZMCt3bCtsTW9obFQxejAzVk53WkVjdFpJeGVtQ1NSbENTYXR5U0xaelQ0eldlL0dYciszYkJXK3FxYW4KYkNxak9BVUNnWUVBOHAzdmloc0FjZU5DeThiaHNVenc5OEhPWGUxS2h5V2RsQXNOUmx2N0dZV2FWTmN5b0phZwpGRkR3elBTaCt3cHIzUk9QZWV4R2hIbm9KM0FPOUh4VXpCN3ZROUJhSDdTRjVvT2t6R1F2T2VKTC8vbExocHVPCjc2Uml2Rit1WXZvTmgrdXRxTzhZUHBVMGh4OVhlTy9DdVJmSUdrSy9LbVJGYU9jZmI3MnBtNDhDZ1lFQTJnckgKZHFMN0tVSkhyNGd6VXE2K3AzblZ1MWZJUCtUN3RjTGJKeVMrc2NYbkZOZzRQS0c3Mm51MDM3R1pXS1o1ejFBZAphUVh2U3dsN295dS9KT0tyZGEvbTQxMGROY0V5WEsrdFZUcE9qWTFKTFZxRjhIQS9sOWloT082Y2E1MWZGc2owCjBPTlE5S05PV04yRlRtRmFIUGdETXovSE80Rjh2Sm1PRnpIeFAvY0NnWUVBemlCZzQzVU5hN1VwaXZmdHlEVVcKaFdpamJDbXVxQ1BOUFhvbVRTRFl0VlpOU01lTXUrTTlIZ1dta0h0SEk0STNJaHo4U1JuMHo1akRKTDZQOWllcgo0OEJraDdqODJQTUcwRklJTVo3c2dNRkMwTGQ4ODJBMmtHT1pmM0hMTjB3N01yK0pTMzNYbTFRb3pLUlVMT3VICkJMcXZ4NS90eXBabVlqbjYrM1NvSlFFQ2dZQndmSE1ldjBJM3JOdnlzSjlabnBENU1aK1VBTnRzS3lPNFI0aHMKRDBiWnk3RkZUYTdsaU1LekduTGJuSEh5RENCM1ZXdDJ6UHNBaVNuaHFpWDRUNEFKUFBBdWg5RVQ5RkdaQTRDMgpvVmY1S3RSL3MxMjZCdzZudGJpbStHSjJHai8rTHpvdHNiZ0lIVi9EOUxSYkZWbzU2N0VxOVZKQlhySU5VbUs5CmtLUlhUUUtCZ0Jxa3ZDdVFCaWI4Y1piVjVHcTgzd0cyZzN2STJPOExCNTcvRDZIU2xhTmJNS1pLU3hWMEJ5L3QKZEJHZGFTajJLVmc5aG85YzJUR2M4SUxFVXhOaUgrZUdIcmtrSFJJb2luSTVsS3FCZ004OXFBR0UybnNURkhZOQpqZ05pK2NjYnZaYWY4UnRjR0NxYVk2M241NnA2K3VHZ2Jnbm5PakpEeUhWV3ljaVd2VVlMCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
kind: Secret
metadata:
  name: s2i-webhook-server-cert
  namespace: kubesphere-devops-system
type: Opaque
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    prometheus.io/port: "8080"
    prometheus.io/scheme: http
    prometheus.io/scrape: "true"
  labels:
    app: s2i-metrics
    control-plane: s2i-controller-manager
    controller-tools.k8s.io: "1.0"
  name: s2ioperator-metrics-service
  namespace: kubesphere-devops-system
spec:
  ports:
  - name: http
    port: 8080
    targetPort: 8080
  selector:
    control-plane: s2i-controller-manager
    controller-tools.k8s.io: "1.0"
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: s2i-trigger-service
    control-plane: s2i-controller-manager
    controller-tools.k8s.io: "1.0"
  name: s2ioperator-trigger-service
  namespace: kubesphere-devops-system
spec:
  ports:
  - name: http
    port: 8081
    targetPort: 8081
  selector:
    control-plane: s2i-controller-manager
    controller-tools.k8s.io: "1.0"
---
apiVersion: v1
kind: Service
metadata:
  name: webhook-server-service
  namespace: kubesphere-devops-system
spec:
  ports:
  - port: 443
    targetPort: 443
  selector:
    control-plane: s2i-controller-manager
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  labels:
    control-plane: s2ioperator
    controller-tools.k8s.io: "1.0"
  name: s2ioperator
  namespace: kubesphere-devops-system
spec:
  selector:
    matchLabels:
      control-plane: s2i-controller-manager
      controller-tools.k8s.io: "1.0"
  serviceName: s2ioperator
  template:
    metadata:
      annotations:
        prometheus.io/scrape: "true"
      labels:
        control-plane: s2i-controller-manager
        controller-tools.k8s.io: "1.0"
    spec:
      containers:
      - command:
        - /manager
        env:
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: S2IIMAGENAME
          value: "{{ s2irun_repo }}:{{ s2irun_tag }}"
        image: "{{ s2ioperator_repo }}:{{ s2ioperator_tag }}"
        imagePullPolicy: IfNotPresent
        name: manager
        ports:
        - containerPort: 8080
          name: metrics
          protocol: TCP
        - containerPort: 8081
          name: trigger
          protocol: TCP
        resources:
          limits:
            cpu: 100m
            memory: 500Mi
          requests:
            cpu: 100m
            memory: 20Mi
        volumeMounts:
        - mountPath: /tmp/k8s-webhook-server/serving-certs
          name: cert
          readOnly: true
      terminationGracePeriodSeconds: 10
      volumes:
      - name: cert
        secret:
          defaultMode: 420
          secretName: s2i-webhook-server-cert
